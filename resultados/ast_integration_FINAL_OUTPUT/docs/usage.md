# Usage Guide for `llm-token-optimizer`

This document provides a comprehensive guide on how to use the `llm-token-optimizer` library to optimize code for Large Language Models (LLMs) by reducing token count and then reconstructing it.

## Installation (Placeholder)

*(Instructions on how to install the library will go here once it's packaged, e.g., `pip install llm-token-optimizer`)*

## Public API

The `llm-token-optimizer` library exposes its core functionalities through a simple public API, primarily consisting of two functions: `reduce_code` and `reconstruct_code`.

### `reduce_code(code: str) -> str`

This function takes a string of source code as input and returns a reduced version of that code. The reduction process aims to minimize the token count for LLMs while preserving the semantic integrity and functionality of the original code. This typically involves removing comments, excess whitespace, simplifying expressions, and potentially applying other token-saving transformations.

**Parameters:**

*   `code` (str): The original source code string that needs to be reduced.

**Returns:**

*   (str): The reduced version of the input code.

**Considerations:**

*   The exact reduction applied may vary based on internal heuristics and future optimizations.
*   While the goal is to preserve semantic equivalence, the reduced code might look significantly different from the original.
*   This function is ideal for preparing code snippets to be fed into LLMs where token limits are a concern.

**Example Usage:**
from llm_token_optimizer.api import reduce_code

original_code = """
# This is a sample Python function
def calculate_sum(a, b):
    # Add two numbers
    result = a + b # Simple addition
    return result # Return the sum
"""

reduced_code = reduce_code(original_code)
print("--- Original Code ---")
print(original_code)
print("\n--- Reduced Code ---")
print(reduced_code)

# Expected output for reduced_code might be something like:
# def calculate_sum(a,b):result=a+b;return result
# (Actual output depends on the reducer's implementation)
### `reconstruct_code(reduced_code: str) -> str`

This function takes a previously reduced code string and attempts to reconstruct it into a more readable or semantically equivalent form. The reconstruction process aims to restore elements like proper indentation, newlines, and potentially some comments or structural clarity, making the code more human-readable while maintaining its original logic.

**Parameters:**

*   `reduced_code` (str): The reduced code string, typically generated by `reduce_code`.

**Returns:**

*   (str): The reconstructed version of the code.

**Considerations:**

*   The reconstructed code might not be byte-for-byte identical to the *original* code, especially if the reduction process involved significant transformations (e.g., variable renaming, complex expression simplification). However, it should be functionally equivalent and significantly more readable than the reduced form.
*   The quality of reconstruction depends heavily on the information preserved during the reduction phase.

**Example Usage:**
from llm_token_optimizer.api import reduce_code, reconstruct_code

original_code = """
def factorial(n):
    if n == 0:
        return 1
    else:
        return n * factorial(n-1)
"""

# Step 1: Reduce the code
reduced_code = reduce_code(original_code)
print("--- Reduced Code ---")
print(reduced_code)

# Step 2: Reconstruct the code
reconstructed_code = reconstruct_code(reduced_code)
print("\n--- Reconstructed Code ---")
print(reconstructed_code)

# Expected output for reconstructed_code might be something like:
# def factorial(n):
#     if n == 0:
#         return 1
#     else:
#         return n * factorial(n - 1)
# (Actual output depends on the reconstructor's implementation)
## Workflow Example: Optimizing for LLM Input and Human Readability

A common use case involves reducing code for LLM processing and then reconstructing it for display or further human interaction.
from llm_token_optimizer.api import reduce_code, reconstruct_code

# A more complex code snippet
complex_code = """
import os
import sys

# This function reads a file and returns its content
def read_file_content(filepath):
    try:
        with open(filepath, 'r') as f:
            content = f.read()
        return content
    except FileNotFoundError:
        print(f"Error: File not found at {filepath}", file=sys.stderr)
        return None
    except Exception as e:
        print(f"An unexpected error occurred: {e}", file=sys.stderr)
        return None

# Main execution block
if __name__ == "__main__":
    file_to_read = "example.txt" # Assume this file exists for testing
    file_content = read_file_content(file_to_read)
    if file_content:
        print("File content successfully read.")
        # Further processing could happen here
    else:
        print("Failed to read file content.")
"""

print("--- Original Complex Code ---")
print(complex_code)

# 1. Reduce the code for LLM input
llm_optimized_code = reduce_code(complex_code)
print("\n--- LLM Optimized (Reduced) Code ---")
print(llm_optimized_code)

# 2. Reconstruct the code for human review/display
human_readable_code = reconstruct_code(llm_optimized_code)
print("\n--- Human Readable (Reconstructed) Code ---")
print(human_readable_code)